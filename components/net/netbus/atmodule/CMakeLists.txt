sdk_generate_library()

sdk_add_include_directories(include)
sdk_add_include_directories(include/at_base)
sdk_add_include_directories(include/at_ble)
sdk_add_include_directories(include/at_bredr)
sdk_add_include_directories(include/at_http)
sdk_add_include_directories(include/at_mqtt)
sdk_add_include_directories(include/at_net)
sdk_add_include_directories(include/at_user)
sdk_add_include_directories(include/at_wifi)
sdk_add_include_directories(include/at_utils)
sdk_add_include_directories(include/at_pwr)

sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BASE src/at_base/at_base_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BASE src/at_base/at_base_config.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BLUETOOTH src/at_ble/at_ble_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BLUETOOTH src/at_ble/at_ble_config.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BLUETOOTH src/at_ble/at_ble_main.c)
if(CONFIG_ATMODULE_HTTP AND CONFIG_ATMODULE_NETWORK)
sdk_library_add_sources(src/at_http/at_http_cmd.c)
sdk_library_add_sources(src/at_http/at_httpc_main.c)
endif()
if(CONFIG_ATMODULE_MQTT AND CONFIG_ATMODULE_NETWORK)
sdk_library_add_sources(src/at_mqtt/at_mqtt_cmd.c)
sdk_library_add_sources(src/at_mqtt/at_mqtt_config.c)
endif()
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NETWORK src/at_net/at_net_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NETWORK src/at_net/at_net_config.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NETWORK src/at_net/at_net_main.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NETWORK src/at_net/at_net_ssl.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NETWORK src/at_net/at_net_ping.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NETWORK src/at_net/at_net_sntp.c)
sdk_library_add_sources(src/at_user/at_user_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_WIFI src/at_wifi/at_wifi_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_WIFI src/at_wifi/at_wifi_config.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_WIFI src/at_wifi/at_wifi_main.c)
sdk_library_add_sources(src/at_utils/at_utils.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_OTA src/at_utils/at_ota.c)
sdk_library_add_sources(src/at_config.c)
sdk_library_add_sources(src/at_core.c)
sdk_library_add_sources(src/at_main.c)
sdk_library_add_sources(src/at_through.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_LP src/at_pwr/at_pwr_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BASE src/at_base/at_base_cmd.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_BASE src/at_base/at_base_config.c)

sdk_library_add_sources(src/at_base/at_fs.c)
sdk_library_add_sources(src/at_port/at_port_fs.c)
sdk_library_add_sources(src/at_port/at_pal.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_FS src/at_port/at_port_littlefs.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_MINIDUMP src/at_utils/at_minidump.c)

sdk_library_add_sources_ifdef(CONFIG_SPISYNC src/at_port/at_port_spi.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_NXSPI src/at_port/at_port_spi.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_UART src/at_port/at_port_uart.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_USB src/at_port/at_port_usb.c)
sdk_library_add_sources_ifdef(CONFIG_ATMODULE_TTY src/at_port/at_port_tty.c)

sdk_library_add_sources_ifdef(CONFIG_WL80211 src/at_wifi/at_wifi_wl80211.c)
sdk_library_add_sources_ifdef(CONFIG_FHOST src/at_wifi/at_wifi_fhost.c)
#sdk_add_compile_definitions(-DCONFIG_AT_FAST_OTA=1)
sdk_add_compile_definitions_ifdef(CONFIG_ATMODULE_MQTT           -DMQTT_USE_CUSTOM_SOCKET_HANDLE=1)
sdk_add_compile_definitions_ifdef(CONFIG_LPAPP                   -DCONFIG_ATMODULE_LP=1)
# Low Power Mode: need CFG_BL_WIFI_PS_ENABLE to avoid PSM_EVENT redefinition in at_pwr_cmd.c
sdk_add_compile_definitions_ifdef(CONFIG_LPAPP                   -DCFG_BL_WIFI_PS_ENABLE)
sdk_add_compile_definitions(-DCONFIG_CHIP_CPUNAME="${BOARD}")

# transport choice
add_subdirectory(transport)
